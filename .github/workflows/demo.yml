name: samples.txt to storage account
on: [push, pull_request, workflow_dispatch]
jobs:
  run:
    runs-on: [windows-latest]
    steps:
    - name: Checkout 
      uses: actions/checkout@v2
    - name: Create a artifact
      uses: actions/upload-artifact@v3
      with:
            name: my-artifact
            path: ${{ github.workspace }}/Files/sample.txt
            
    - name: Create a blob arifact
      uses: fixpoint/azblob-upload-artifact@v4
      with:
          connection-string: DefaultEndpointsProtocol=https;AccountName=acnintestccinfrasa;AccountKey=169zg+KE4dBlqLS3//H3eb/+ysB7wHAq35gU9FpxxK8NO+x/gZ9SASjtSulAVsHBagwuw3iK6OOZ+AStlBRfFw==;EndpointSuffix=core.windows.net
          name: my-artifact
          path: ${{ github.workspace }}/Files/sample.txt
    - run: cat ${{ github.workspace }}/Files/sample.txt
    - name: Azure Login
    - uses: actions/checkout@v3
    - uses: azure/login@v1
      with:
          creds: ${{ secrets.AZURE_CREDENTIALS }}
    - name: Upload to blob storage
      uses: azure/CLI@v1
      with:
        inlineScript: |
            az storage blob upload-batch --account-name "acnintestccinfrasa" --auth-mode key -d '$web' -s .
        

